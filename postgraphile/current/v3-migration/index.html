<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-4.x plugin-docs plugin-id-default docs-doc-id-v3-migration">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Migrating from PostGraphQL v3 | PostGraphile</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://postgraphile.org/postgraphile/current/v3-migration"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="4.x"><meta data-rh="true" name="docusaurus_tag" content="docs-default-4.x"><meta data-rh="true" name="docsearch:version" content="4.x"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-4.x"><meta data-rh="true" property="og:title" content="Migrating from PostGraphQL v3 | PostGraphile"><meta data-rh="true" name="description" content="Despite the fact that PostGraphile v4 has rewritten the entire GraphQL schema"><meta data-rh="true" property="og:description" content="Despite the fact that PostGraphile v4 has rewritten the entire GraphQL schema"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://postgraphile.org/postgraphile/current/v3-migration"><link data-rh="true" rel="alternate" href="https://postgraphile.org/postgraphile/current/v3-migration" hreflang="en"><link data-rh="true" rel="alternate" href="https://postgraphile.org/postgraphile/current/v3-migration" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://T47OLMXAXW-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="PostGraphile" href="/opensearch.xml">

<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="PostGraphile RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="PostGraphile Atom Feed">

<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Sarabun"><link rel="stylesheet" href="/assets/css/styles.b5934424.css">
<link rel="preload" href="/assets/js/runtime~main.80bf8250.js" as="script">
<link rel="preload" href="/assets/js/main.4f3a8e0c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_G6ar" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_ncOr" role="banner"><div class="content_L1uV announcementBarContent__57G">This documentation is a work in progress, please forgive gaps, and feel free to send pull requests!</div></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="PostGraphile Logo" class="themedImage_RWGG themedImage--light_riBm"><img src="/img/logo.svg" alt="PostGraphile Logo" class="themedImage_RWGG themedImage--dark_Dsi0"></div><b class="navbar__title text--truncate">PostGraphile</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/postgraphile/current/">Documentation</a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/postgraphile/current/">4.x</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/postgraphile/next/">Next</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/postgraphile/current/v3-migration">4.x</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/news">News</a><a class="navbar__item navbar__link" href="/sponsor">Sponsor</a><a class="navbar__item navbar__link" href="/pricing">Go Pro</a><a href="https://www.graphile.org/support/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_awgD"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/graphile/crystal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_awgD"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_OLSw colorModeToggle_Hg9V"><button class="clean-btn toggleButton_wYmb toggleButtonDisabled_vaDU" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Sxwe"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_Yem1"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_xrOJ"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_UyTV docsWrapper_BqXd"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_z1FD" type="button"></button><div class="docPage_pOTq"><aside class="theme-doc-sidebar-container docSidebarContainer_aIKW"><div class="sidebarViewport_DwR9"><div class="sidebar_vJCc"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_qiME menuWithAnnouncementBar_hRfJ"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><h4>OVERVIEW</h4></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/postgraphile/current/examples/">Example Gallery</a><button aria-label="Toggle the collapsible sidebar category &#x27;Example Gallery&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/postgraphile/current/usage">Usage</a><button aria-label="Toggle the collapsible sidebar category &#x27;Usage&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/performance">Performance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/requirements">Requirements</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/required-knowledge">Required Knowledge</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><h4>OPERATION</h4></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/quick-start-guide">Quick Start Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/namespaces">Namespaces (PostgreSQL &quot;schemas&quot;)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/inflection">Inflection</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/postgraphile/current/tables">Tables</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tables&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/postgraphile/current/functions">Functions</a><button aria-label="Toggle the collapsible sidebar category &#x27;Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/enums">Enums</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/views">Views</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/aggregates">Aggregates</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/postgresql-indexes">PostgreSQL Indexes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/security">Security</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/postgraphile/current/realtime">Realtime</a><button aria-label="Toggle the collapsible sidebar category &#x27;Realtime&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/background-tasks">Background Tasks in PostGraphile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/reserved-keywords">Reserved Keywords / Table Names</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/debugging">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><h4>CUSTOMISING</h4></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/postgraphile/current/smart-tags">Smart Tags</a><button aria-label="Toggle the collapsible sidebar category &#x27;Smart Tags&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/postgraphile/current/extending">Schema Plugins</a><button aria-label="Toggle the collapsible sidebar category &#x27;Schema Plugins&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/plugins">Server Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><h4>GUIDES</h4></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/postgresql-schema-design">PostgreSQL Schema Design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/evaluating">Evaluating</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/best-practices">PostGraphile best practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/production">Production Considerations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/jwt-guide">PostGraphile JWT Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/jwk-verification">PostGraphile JWT/JWK Verification Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/default-role">Default Role</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/pg-pubsub-migration">Migrating from the Supporter Plugin to @graphile/pg-pubsub</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/v4-new-features">v4 Feature Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/postgraphile/current/v3-migration">Migrating from PostGraphQL v3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/testing-jest">Testing with Jest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/bundling-webpack">Bundling PostGraphile with Webpack</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/multiple-schemas">Multiple GraphQL Schemas with PostGraphile</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/running-postgraphile-in-docker">Running PostGraphile in Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/running-postgraphile-as-a-library-in-docker">Running PostGraphile as a library in Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><h4>DEPLOYING</h4></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/deploying-heroku">Deploying to Heroku</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/deploying-docker">Deploying with Docker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/deploying-lambda">Deploying to AWS Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/deploying-gcp">Deploying to GCP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><h4>COMMUNITY</h4></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/community-contributions">Community contributions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/community-chat">PostGraphile chat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/code-of-conduct">Code of Conduct</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><h4>FAQ</h4></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/introspection">Introspection?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/why-nullable">Why is it nullable?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/postgraphile/current/versioning-policy">Versioning Policy</a></li></ul></nav></div></div></aside><main class="docMainContainer_fv3b"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_YAwJ"><div class="docItemContainer_Rv5Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_zCmv" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_JFrk"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Migrating from PostGraphQL v3</span><meta itemprop="position" content="1"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 4.x</span><div class="tocCollapsible_O_Qc theme-doc-toc-mobile tocMobile_tjDr"><button type="button" class="clean-btn tocCollapsibleButton_htYj">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Migrating from PostGraphQL v3</h1></header><p>Despite the fact that PostGraphile v4 has rewritten the <em>entire</em> GraphQL schema
generation from scratch it is still broadly compatible with version 3. This
document aims to outline solutions to issues you might face whilst upgrading. If
you face issues that you cannot solve, please do reach out!</p><h3 class="anchor anchorWithStickyNavbar_fF9Z" id="short-list-of-breaking-changes">Short list of breaking changes<a href="#short-list-of-breaking-changes" class="hash-link" aria-label="Direct link to Short list of breaking changes" title="Direct link to Short list of breaking changes">​</a></h3><p>These are things that can&#x27;t be easily solved by just adding a command-line
switch or configuration parameter - if these are a problem for you then please
get in touch and we&#x27;ll discuss how one might go about fixing them (please read
the below first though!)</p><ul><li>Per-function <code>returns setof &lt;table&gt;</code> connection names have been removed in
favour of a shared connection with the tables themselves - only affects you if
you have referenced the type name in queries/fragments</li><li>What&#x27;s nullable and what isn&#x27;t has changed slightly - shouldn&#x27;t cause an issue
in most cases (please read <a href="/postgraphile/current/why-nullable/">Why is it nullable?</a> for an
explanation of why each thing is nullable)</li><li>JWTs now have an audience of &#x27;postgraphile&#x27; rather than &#x27;postgraphql&#x27;, but you
can change this with the <code>--jwt-verify-audience</code> option</li><li>If you have any tables ending with <code>_input</code>, <code>_patch</code>, <code>Input</code> or <code>Patch</code> they
will be renamed (see bottom of this article)</li></ul><h3 class="anchor anchorWithStickyNavbar_fF9Z" id="aside-project-financial-status">Aside: project financial status<a href="#aside-project-financial-status" class="hash-link" aria-label="Direct link to Aside: project financial status" title="Direct link to Aside: project financial status">​</a></h3><p><strong>If your business uses PostGraphile, please invest in
<a href="https://www.patreon.com/benjie" target="_blank" rel="noopener noreferrer">our Patreon</a></strong> - you&#x27;ll benefit from faster
fixes, more features, and better performance. If you need a more commercially
justifiable way of funding the project then please
<a href="mailto:team@graphile.org?subject=Giving%20back" target="_blank" rel="noopener noreferrer">get in touch</a>.</p><h3 class="anchor anchorWithStickyNavbar_fF9Z" id="deprecations">Deprecations<a href="#deprecations" class="hash-link" aria-label="Direct link to Deprecations" title="Direct link to Deprecations">​</a></h3><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="one-to-one-backward-relations">One-to-one backward relations<a href="#one-to-one-backward-relations" class="hash-link" aria-label="Direct link to One-to-one backward relations" title="Direct link to One-to-one backward relations">​</a></h4><p>These are now supported, so the previous one-to-many approximation for them has
been deprecated. If you can do so we encourage you to remove the old API via
<code>--legacy-relations=omit</code> (or <code>legacyRelations: &#x27;omit&#x27;</code> in the library version);
however by default we include both relations. If for some reason you don&#x27;t want
the deprecation and you don&#x27;t want the new behaviour (why?! It&#x27;s so much
better!) then you can enable the old behaviour only via
<code>--legacy-relations=only</code>.</p><p>Example:</p><div class="language-sql codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_qZBB"><pre tabindex="0" class="prism-code language-sql codeBlock_TAPP thin-scrollbar"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> foo </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  id </span><span class="token keyword" style="color:#00009f">serial</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">primary</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">table</span><span class="token plain"> bar </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  foo_id </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">not</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">null</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">primary</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">key</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">references</span><span class="token plain"> foo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  name </span><span class="token keyword" style="color:#00009f">text</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_TNwR"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MVhB" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yxgH"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_QJLJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-graphql codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_qZBB"><pre tabindex="0" class="prism-code language-graphql codeBlock_TAPP thin-scrollbar"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property-query">fooById</span><span class="token punctuation" style="color:#393A34">(</span><span class="token attr-name" style="color:#00a4db">id</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Old interface - deprecated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># Note: this connection can only return at most one result so doesn&#x27;t</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># deserve a connection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token object">barsByFooId</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token object">edges</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token object">node</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token property" style="color:#36acaa">name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># New interface - no more indirection!</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token object">barByFooId</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_TNwR"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MVhB" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yxgH"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_QJLJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_fF9Z" id="breakdown-of-issues-you-might-face">Breakdown of issues you might face<a href="#breakdown-of-issues-you-might-face" class="hash-link" aria-label="Direct link to Breakdown of issues you might face" title="Direct link to Breakdown of issues you might face">​</a></h3><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="new-minimum-requirements">New minimum requirements<a href="#new-minimum-requirements" class="hash-link" aria-label="Direct link to New minimum requirements" title="Direct link to New minimum requirements">​</a></h4><p><strong>Problem</strong>: the system fails to start (or even install) because the
requirements are not met.</p><p><strong>Solution</strong>: upgrade your software</p><ul><li>Node.js v8.6+ required</li><li>PostgreSQL 9.4+ required (v9.6+ recommended)</li><li>GraphQL v0.9+ required</li></ul><p><strong>Reasoning</strong>: Node.js v8 is the current active LTS, v6 will be leaving active
LTS status for maintenance mode in April 2018 (next month at time of writing),
and supporting 8.6+ as the base level gives us longevity whilst also allowing us
to leverage native support for some of the powerful features of ES2017 and
ES2018.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="type-json-or-uuid-is-not-recognized">Type &#x27;Json&#x27; or &#x27;Uuid&#x27; is not recognized<a href="#type-json-or-uuid-is-not-recognized" class="hash-link" aria-label="Direct link to Type &#x27;Json&#x27; or &#x27;Uuid&#x27; is not recognized" title="Direct link to Type &#x27;Json&#x27; or &#x27;Uuid&#x27; is not recognized">​</a></h4><p><strong>Problem</strong>: <code>Json</code> and <code>Uuid</code> have been renamed to <code>JSON</code> and <code>UUID</code>
respectively</p><p><strong>Solution</strong>: either modify your queries, or if you cannot do that then use the
<code>--legacy-json-uuid</code> command line flag (or <code>legacyJsonUuid: true</code> library
option) to change back to the old naming.</p><p><strong>Reasoning</strong>: purely correctness/aesthetic. Sorry. 😅</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="connection-orderby-is-now-an-array">Connection <code>orderBy</code> is now an array<a href="#connection-orderby-is-now-an-array" class="hash-link" aria-label="Direct link to connection-orderby-is-now-an-array" title="Direct link to connection-orderby-is-now-an-array">​</a></h4><p><strong>Problem</strong>: <code>orderBy</code> in connection fields now allows an array of order
specifications, so you can order by multiple things (like in SQL). However
certain clients might have a problem with this?</p><p><strong>Solution</strong>: in most cases this should <em>not</em> cause an issue for existing
queries - according to
<a href="https://graphql.github.io/graphql-spec/October2016/#sec-Lists" target="_blank" rel="noopener noreferrer">3.1.7 in the GraphQL specification</a>:</p><blockquote><p>If the value passed as an input to a list type is not a list and not the null
value, it should be coerced as though the input was a list of size one, where
the value passed is the only item in the list.</p></blockquote><p>So any spec-compliant client should <strong>not</strong> have an issue with this.</p><p><strong>Reasoning</strong>: people want to sort by multiple columns and since we could do it
with a non-breaking change (according to the above) we did!</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="expected-uuid-but-received-string">Expected &#x27;UUID&#x27; but received &#x27;String&#x27;<a href="#expected-uuid-but-received-string" class="hash-link" aria-label="Direct link to Expected &#x27;UUID&#x27; but received &#x27;String&#x27;" title="Direct link to Expected &#x27;UUID&#x27; but received &#x27;String&#x27;">​</a></h4><p><strong>Problem</strong>: &#x27;UUID&#x27; is enabled by default</p><p><strong>Solution</strong>: raise an issue and we can add a toggle to not enable it by default</p><p><strong>Reasoning</strong>: named types are helpful</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="jwts-now-have-audience-postgraphile--issuer-postgraphile">JWTs now have audience &#x27;postgraphile&#x27; / issuer &#x27;postgraphile&#x27;<a href="#jwts-now-have-audience-postgraphile--issuer-postgraphile" class="hash-link" aria-label="Direct link to JWTs now have audience &#x27;postgraphile&#x27; / issuer &#x27;postgraphile&#x27;" title="Direct link to JWTs now have audience &#x27;postgraphile&#x27; / issuer &#x27;postgraphile&#x27;">​</a></h4><p><strong>Problem</strong>: we changed the audience with the rename of the library</p><p><strong>Solution</strong>: if you can&#x27;t update your config you can make sure your token
objects returned in the DB have <code>aud: &#x27;postgraphql&#x27;, iss: &#x27;postgraphql&#x27;</code>
(solution untested - if you used this please let
<a href="https://twitter.com/benjie" target="_blank" rel="noopener noreferrer">me</a> know whether it worked or not)</p><p><strong>Reasoning</strong>: we renamed the library, it&#x27;d be confusing for new users to
reference the old name.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="functions-now-use-table-connections-where-possible-again">Functions now use table connections where possible (again!)<a href="#functions-now-use-table-connections-where-possible-again" class="hash-link" aria-label="Direct link to Functions now use table connections where possible (again!)" title="Direct link to Functions now use table connections where possible (again!)">​</a></h4><p><strong>Problem</strong>: functions that return setof a table type now use the same
connection class as the tables themselves do (just like PostGraphQL v2 did)</p><p><strong>Solution</strong>: if this is a problem for you and you&#x27;re unable to fix the queries,
please do get in touch!</p><p><strong>Reasoning</strong>: performing pagination against multiple sources of the same table
type is much more complex if the connection types differ.</p><p><strong>Potential future solution</strong>: have the connections implement a shared
interface.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="issues-with-nullables">Issues with nullables<a href="#issues-with-nullables" class="hash-link" aria-label="Direct link to Issues with nullables" title="Direct link to Issues with nullables">​</a></h4><p><strong>Problem</strong>: some things are nullable that weren&#x27;t, some things aren&#x27;t nullable
that were.</p><p><strong>Solution</strong>: you can enable the <code>--no-setof-functions-contain-nulls</code> CLI option
(or <code>setofFunctionsContainNulls: false</code> library option) to reduce the nullables
in the generated schema.</p><p><strong>Reasoning</strong>:</p><p>Functions like this can exist:</p><div class="language-sql codeBlockContainer_ZGJx theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_qZBB"><pre tabindex="0" class="prism-code language-sql codeBlock_TAPP thin-scrollbar"><code class="codeBlockLines_AdAo"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">create</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">badly_behaved_function</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">returns</span><span class="token plain"> setof c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">person </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> $$</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">begin</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> query </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">person </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> id </span><span class="token keyword" style="color:#00009f">asc</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">next</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> query </span><span class="token keyword" style="color:#00009f">select</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">person </span><span class="token keyword" style="color:#00009f">order</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> id </span><span class="token keyword" style="color:#00009f">desc</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">limit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">end</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$$ </span><span class="token keyword" style="color:#00009f">language</span><span class="token plain"> plpgsql stable</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_TNwR"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_MVhB" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_yxgH"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_QJLJ"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This function returns an array of <code>[{person}, null, {person}]</code> where <code>{person}</code>
is a Person object. In PostGraphile because it is a <code>setof</code> function we treat it
as a connection. As explained above, we now (like in version 2) use the same
connections for functions as for tables - as such these connections now have to
support that the entries within them are nullable.</p><p>If you don&#x27;t like the nulls everywhere, I encourage you to use the <code>-N</code> /
<code>--no-setof-functions-contain-nulls</code> option mentioned above. Enabling this is a
non-breaking change, but disabling it <strong>is</strong> a breaking change - hence why it is
not the default behaviour.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="fields-in-create-mutations-now-respect-defaults">Fields in create mutations now respect defaults<a href="#fields-in-create-mutations-now-respect-defaults" class="hash-link" aria-label="Direct link to Fields in create mutations now respect defaults" title="Direct link to Fields in create mutations now respect defaults">​</a></h4><p>In v3, omitting a field from a create mutation would cause it to be set to
<code>NULL</code>, ignoring the column default. We fixed this in v4, now if you want to set
the column null you must specify NULL in the mutation (rather than omitting the
key).</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="query-procedures-that-returns-setof-scalar-no-longer-have-pageinfo-nor-totalcount">Query procedures that <code>returns setof &lt;scalar&gt;</code> no longer have <code>pageInfo</code> nor <code>totalCount</code><a href="#query-procedures-that-returns-setof-scalar-no-longer-have-pageinfo-nor-totalcount" class="hash-link" aria-label="Direct link to query-procedures-that-returns-setof-scalar-no-longer-have-pageinfo-nor-totalcount" title="Direct link to query-procedures-that-returns-setof-scalar-no-longer-have-pageinfo-nor-totalcount">​</a></h4><p><strong>Problem</strong>: as heading.</p><p><strong>Solution</strong>: it&#x27;s possibly to re-introduce support via a plugin - get in touch
if you need this</p><p><strong>Reasoning</strong>: I did not feel it was particularly necessary and I&#x27;ve only got
limited time to work on the project...</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="watch-schema-has-changed">Watch schema has changed<a href="#watch-schema-has-changed" class="hash-link" aria-label="Direct link to Watch schema has changed" title="Direct link to Watch schema has changed">​</a></h4><p><em>Note that changes to the watch schema are NOT deemed to be breaking changes.</em></p><p><strong>Problem</strong>: watch schema has changed to fix issues with dropping objects</p><p><strong>Solution</strong>: most people shouldn&#x27;t be affected by this (though they might want
to drop the old watch schema) because <code>--watch</code> is only intended for development
use and the new schema should install itself just fine. But if you had to
manually install the old watch schema, you&#x27;ll need to manually install the
<a href="https://github.com/graphile/graphile-engine/blob/master/packages/graphile-build-pg/res/watch-fixtures.sql" target="_blank" rel="noopener noreferrer">new one</a>
in the same way</p><p><strong>Reasoning</strong>: the old schema did not detect certain <code>DROP</code> commands and so
adding tables, columns, functions, etc. to your schema was fine, but removing
them did not result in a refresh.</p><h3 class="anchor anchorWithStickyNavbar_fF9Z" id="other-changes-that-may-affect-you">Other changes that may affect you<a href="#other-changes-that-may-affect-you" class="hash-link" aria-label="Direct link to Other changes that may affect you" title="Direct link to Other changes that may affect you">​</a></h3><p>These are things that I doubt affect many people (if any) but I want to raise so
you can check your own applications.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="introspection-query-has-changed">Introspection query has changed<a href="#introspection-query-has-changed" class="hash-link" aria-label="Direct link to Introspection query has changed" title="Direct link to Introspection query has changed">​</a></h4><p>And will probably continue to change. Changes to the introspection query are not
deemed to be breaking changes. The introspection query is now programatically
generated so that we can support PG10 and PG11 features.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="field-descriptions-have-changed-a-little">Field descriptions have changed a little<a href="#field-descriptions-have-changed-a-little" class="hash-link" aria-label="Direct link to Field descriptions have changed a little" title="Direct link to Field descriptions have changed a little">​</a></h4><p>Field description changes are not deemed to be breaking changes.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="case-changing-library-has-changed">Case changing library has changed<a href="#case-changing-library-has-changed" class="hash-link" aria-label="Direct link to Case changing library has changed" title="Direct link to Case changing library has changed">​</a></h4><p>We replaced the library but this doesn&#x27;t affect any of the tests. If this causes
you pain please submit an issue so we can add your fields/table names/etc to the
tests to ensure this doesn&#x27;t happen again.</p><p>Workaround: you can change the inflection engine back to the old one with a
plugin - <a href="/postgraphile/current/make-add-inflectors-plugin/">see <code>makeAddInflectorsPlugin</code></a>.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="procedures-that-only-supported-orderby-natural-now-do-not-have-orderby-at-all">Procedures that only supported <code>orderBy: NATURAL</code> now <strong>do not have <code>orderBy</code> at all</strong>.<a href="#procedures-that-only-supported-orderby-natural-now-do-not-have-orderby-at-all" class="hash-link" aria-label="Direct link to procedures-that-only-supported-orderby-natural-now-do-not-have-orderby-at-all" title="Direct link to procedures-that-only-supported-orderby-natural-now-do-not-have-orderby-at-all">​</a></h4><p>Though technically a breaking change, I&#x27;m not deeming it as such because I don&#x27;t
understand why you&#x27;d explicitly set the orderBy for a field that only has one
value and that value is enabled by default.</p><p>If this is a problem for you please get in touch and we can add support back via
a simple plugin.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="using-a-return-type-postgraphile-user-cant-access">Using a return type PostGraphile user can&#x27;t access<a href="#using-a-return-type-postgraphile-user-cant-access" class="hash-link" aria-label="Direct link to Using a return type PostGraphile user can&#x27;t access" title="Direct link to Using a return type PostGraphile user can&#x27;t access">​</a></h4><p><code>security definer</code> mutations that return a type from a schema that the
requesting PostgreSQL user is not allowed to view may now result in
<code>permission denied for schema xxxx</code>.</p><p><strong>Solution</strong>: don&#x27;t do that 😉</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="conflicting-tables-names---_input-_patch">Conflicting tables names - <code>*_input</code>, <code>*_patch</code><a href="#conflicting-tables-names---_input-_patch" class="hash-link" aria-label="Direct link to conflicting-tables-names---_input-_patch" title="Direct link to conflicting-tables-names---_input-_patch">​</a></h4><p>Tables that end in <code>_input</code> or <code>_patch</code> such as <code>foo_input</code> will no longer be
exported as <code>FooInput</code> but as <code>FooInputRecord</code> - this prevents collisions with
mutation types on tables that share the prefix (e.g. table <code>foo</code>/<code>foos</code> requires
<code>FooInput</code> for its create mutation).</p><p>Even if they don&#x27;t clash <em>right now</em> there&#x27;s a risk that they will clash in
future; e.g. if you create the table <code>foo_bar_input</code> then creating <code>FooBarInput</code>
and <code>FooBarInputInput</code> and <code>FooBarInputPatch</code> is fine... But if you later add
the table <code>foo_bar</code> then <code>FooBarInput</code> will clash. So renaming the tables up
front means that whether or not you add that table later it&#x27;ll still be fine
without breaking existing functionality.</p><p>You can rename tables directly, or if you prefer not to change your database
layout you can use <a href="/postgraphile/current/smart-comments/">smart comments</a> or write a custom
<a href="/postgraphile/current/inflection/">inflector</a>.</p><h4 class="anchor anchorWithStickyNavbar_fF9Z" id="very-large-numbers">Very large numbers<a href="#very-large-numbers" class="hash-link" aria-label="Direct link to Very large numbers" title="Direct link to Very large numbers">​</a></h4><p>Large integers (over 4 bytes) are still referred to as <code>BigInt</code>, large floats
(those beyond IEEE754) are now called <code>BigFloat</code>. The specific boundaries in
which these new types kick in may have changed - particularly for
<code>DECIMAL</code>/<code>NUMERIC</code> types. <code>DECIMAL</code>/<code>NUMERIC</code> are likely to change in future
(so that smaller versions might be represented as int/float rather than
BigInt/BigFloat).</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/graphile/crystal/tree/main/postgraphile/website/versioned_docs/version-4.x/v3-migration.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_UohW" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_T23F"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/postgraphile/current/v4-new-features"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">v4 Feature Guide</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/postgraphile/current/testing-jest"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Testing with Jest</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_TN1Q thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#short-list-of-breaking-changes" class="table-of-contents__link toc-highlight">Short list of breaking changes</a></li><li><a href="#aside-project-financial-status" class="table-of-contents__link toc-highlight">Aside: project financial status</a></li><li><a href="#deprecations" class="table-of-contents__link toc-highlight">Deprecations</a></li><li><a href="#breakdown-of-issues-you-might-face" class="table-of-contents__link toc-highlight">Breakdown of issues you might face</a></li><li><a href="#other-changes-that-may-affect-you" class="table-of-contents__link toc-highlight">Other changes that may affect you</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://postgraphile.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">PostGraphile</a></li><li class="footer__item"><a class="footer__link-item" href="/grafast">Gra<em>fast</em></a></li><li class="footer__item"><a href="https://build.graphile.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Graphile Build</a></li><li class="footer__item"><a href="https://star.graphile.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Graphile*</a></li><li class="footer__item"><a href="https://grafast.org/ruru/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Ruru</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/graphile" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_awgD"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/GraphileHQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_awgD"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://fosstodon.org/@graphile" target="_blank" rel="noopener noreferrer" class="footer__link-item">Mastodon<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_awgD"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/graphile/crystal" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_awgD"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://graphile.org/sponsor/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Sponsor<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_awgD"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/logo.svg" alt="PostGraphile Logo" class="themedImage_RWGG themedImage--light_riBm footer__logo" width="64" height="64"><img src="/img/logo.svg" alt="PostGraphile Logo" class="themedImage_RWGG themedImage--dark_Dsi0 footer__logo" width="64" height="64"></div><div class="footer__copyright">Copyright © 2024 Graphile Ltd. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.80bf8250.js"></script>
<script src="/assets/js/main.4f3a8e0c.js"></script>
</body>
</html>