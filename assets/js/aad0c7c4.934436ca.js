"use strict";(self.webpackChunk_localrepo_postgraphile_website=self.webpackChunk_localrepo_postgraphile_website||[]).push([[4986],{30876:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>m});var n=a(2784);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=p(a),d=o,m=c["".concat(l,".").concat(d)]||c[d]||h[d]||r;return a?n.createElement(m,i(i({ref:t},u),{},{components:a})):n.createElement(m,i({ref:t},u))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:o,i[1]=s;for(var p=2;p<r;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},67123:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>p});var n=a(7896),o=(a(2784),a(30876));const r={layout:"page",path:"/postgraphile/evaluating/",title:"Evaluating",fullTitle:"Evaluating PostGraphile For Your Project"},i=void 0,s={unversionedId:"evaluating",id:"evaluating",title:"Evaluating",description:"Hopefully you\u2019ve been convinced that PostGraphile serves an awesome GraphQL API,",source:"@site/postgraphile/evaluating.md",sourceDirName:".",slug:"/evaluating",permalink:"/postgraphile/next/evaluating",draft:!1,editUrl:"https://github.com/graphile/crystal/tree/main/postgraphile/website/postgraphile/evaluating.md",tags:[],version:"current",frontMatter:{layout:"page",path:"/postgraphile/evaluating/",title:"Evaluating",fullTitle:"Evaluating PostGraphile For Your Project"},sidebar:"docs",previous:{title:"PostgreSQL schema design",permalink:"/postgraphile/next/postgresql-schema-design"},next:{title:"PostGraphile best practices",permalink:"/postgraphile/next/best-practices"}},l={},p=[{value:"No Lock-In",id:"no-lock-in",level:3},{value:"Schema Driven APIs",id:"schema-driven-apis",level:3}],u={toc:p},c="wrapper";function h(e){let{components:t,...a}=e;return(0,o.kt)(c,(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Hopefully you\u2019ve been convinced that PostGraphile serves an awesome GraphQL API,\nbut now let\u2019s take a more critical look at whether or not you should adopt\nPostGraphile for your project."),(0,o.kt)("p",null,"PostGraphile\u2019s audience is for people who want to prioritize their product.\nPostGraphile allows you to define your content model in the database as you\nnormally would, however instead of building the bindings to the database (your\nAPI) PostGraphile takes care of it."),(0,o.kt)("p",null,"This takes a huge maintenance burden off your shoulders. Now you don\u2019t have to\nworry about optimizing the API and the database, instead you can focus on just\noptimizing your database. Scaling a database is well-understood - and you can\ncombine techniques - scaling vertically with larger database servers (more RAM,\nfaster storage), or horizontally with read replicas."),(0,o.kt)("h3",{id:"no-lock-in"},"No Lock-In"),(0,o.kt)("p",null,"PostGraphile does not lock you into using PostGraphile forever - in fact most of\nthe work you do implementing a PostGraphile API is in your database, which you\ncan take with you if you chose to move to a different system, so no work is\nlost. If you feel comfortable with the cost of building your API, PostGraphile\nis simple to switch with a custom solution - you can even export the GraphQL SDL\nPostGraphile builds for you so you just need to implement your own resolvers.\nAnd thanks to ",(0,o.kt)("inlineCode",{parentName:"p"},"graphile-export"),", if your plugins support it, you can export\nyour GraphQL schema as executable code including the Gra",(0,o.kt)("em",{parentName:"p"},"fast")," plan resolvers."),(0,o.kt)("p",null,"PostGraphile does not ask you to do anything too divergent with your PostgreSQL\nschema, allowing you to take your schema (and all your data) to whatever\nsolution you build next, and being confident that it was well designed - hand\nrolled by you! GraphQL itself provides a simple and clear deprecation path if\nyou want to start using different fields. And of course with Graphile Build\nplugins you can extend (or remove) functionality as you wish."),(0,o.kt)("p",null,"Further, you can migrate away from PostGraphile bit by bit by placing a GraphQL\nproxy in front of it and redirecting certain resolvers to your new solution.\nThis enables you to move away from PostGraphile with zero downtime."),(0,o.kt)("p",null,"Ideally PostGraphile will scale with your company (get in touch if you're\nfacing scaling issues - we can almost certainly help!), however there is a\nsimple exit path even years into the business. We welcome your contributions to\nhelp PostGraphile scale and meet your needs, and are very open to sponsored\nimprovements to the software."),(0,o.kt)("h3",{id:"schema-driven-apis"},"Schema Driven APIs"),(0,o.kt)("p",null,'If you fundamentally disagree with "one-to-one mapping of a SQL schema to an\nAPI" (GraphQL or otherwise) this section is for you.'),(0,o.kt)("p",null,"First of all, PostGraphile's out of the box behavior is not necessarily meant\nto be the be-all and end-all of your API. PostGraphile was created to allow you\nto focus on your product and not the API. If you need to integrate external\nsystems, there are easy to use ways to extend your schema (e.g.\n",(0,o.kt)("a",{parentName:"p",href:"./make-extend-schema-plugin"},(0,o.kt)("inlineCode",{parentName:"a"},"makeExtendSchemaPlugin")),"). If you want to\nexclude things from your schema, we have a powerful ",(0,o.kt)("a",{parentName:"p",href:"./behavior"},"behavior\nsystem")," you can use to accomplish that using global preferences and\nlocal overrides, or you can simply ",(0,o.kt)("a",{parentName:"p",href:"./extending-raw#removing-things-from-the-schema"},"remove things from the\nschema"),". If you want a custom\nmanually written API there is a simple transition path (read ",(0,o.kt)("a",{parentName:"p",href:"#no-lock-in"},"no lock\nin"),")."),(0,o.kt)("p",null,"If you still can\u2019t get over the auto-generated nature of PostGraphile consider\nthe following arguments why putting your business logic in PostgreSQL is a good\nidea:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"PostgreSQL already has a powerful ",(0,o.kt)("a",{parentName:"li",href:"http://www.postgresql.org/docs/current/static/user-manag.html"},"user management system"),"\nwith fine grained ",(0,o.kt)("a",{parentName:"li",href:"http://www.postgresql.org/docs/current/static/ddl-rowsecurity.html"},"row level security"),". A custom API\nwould mean you have to build your own user management and security, and\nhaving to guarantee that every possible route to your database data is\nvetted by the same permissions logic (which PostgreSQL RLS does for you)."),(0,o.kt)("li",{parentName:"ol"},"PostgreSQL allows you to hide implementation details with ",(0,o.kt)("a",{parentName:"li",href:"http://www.postgresql.org/docs/current/static/sql-createview.html"},"views"),"\nof your data. Simple views can even be ",(0,o.kt)("a",{parentName:"li",href:"http://www.postgresql.org/docs/current/static/sql-createview.html#SQL-CREATEVIEW-UPDATABLE-VIEWS"},"auto-updatable"),".\nThis provides you with the same freedom and flexibility as you might want\nfrom a custom API except more performant."),(0,o.kt)("li",{parentName:"ol"},"PostgreSQL gives you automatic relations with the ",(0,o.kt)("inlineCode",{parentName:"li"},"REFERENCES")," constraint\nand PostGraphile ",(0,o.kt)("a",{parentName:"li",href:"./relations/"},"automatically detects them"),". With a custom\nAPI, you\u2019d need to hardcode these relationships, which can become quite a\nchore!"),(0,o.kt)("li",{parentName:"ol"},"For what it\u2019s worth, you can write in your favorite scripting language in\nPostgreSQL, including ",(0,o.kt)("a",{parentName:"li",href:"https://blog.heroku.com/archives/2013/6/5/javascript_in_your_postgres"},"JavaScript")," and ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/knu/postgresql-plruby"},"Ruby"),"."),(0,o.kt)("li",{parentName:"ol"},"If you don\u2019t want to write your code inside PostgreSQL, you could also use\nPostgreSQL\u2019s ",(0,o.kt)("a",{parentName:"li",href:"http://www.postgresql.org/docs/current/static/sql-notify.html"},(0,o.kt)("inlineCode",{parentName:"a"},"NOTIFY"))," feature to fire events to a listening\nRuby or ",(0,o.kt)("a",{parentName:"li",href:"https://www.npmjs.com/package/pg-pubsub"},"JavaScript")," microservice (this could include email\ntransactions and event reporting), implement a job queue (",(0,o.kt)("a",{parentName:"li",href:"https://github.com/graphile/worker"},"Graphile\nWorker")," is one approach to this), or\nadd a Graphile Build plugin to wrap or replace a PostGraphile plan\nresolver."),(0,o.kt)("li",{parentName:"ol"},"Well implemented",(0,o.kt)("sup",{parentName:"li",id:"fnref-1"},(0,o.kt)("a",{parentName:"sup",href:"#fn-1",className:"footnote-ref"},"1"))," logic in the database can be hundreds or even thousands\nof times faster than implementing the same logic in the application layer\nvia an ORM or similar abstraction; this performance improvement can\neliminate the need for caching and the dreaded cache invalidation problem,\nat least for a while. In the database, all the data is ",(0,o.kt)("em",{parentName:"li"},"right there")," -\nthere's no need for expensive roundtrips over the network, and the\nserialization/deserialization and data transfer costs are eliminated since\nno data is transferred to remote clients.")),(0,o.kt)("p",null,"Still worried about a certain aspect of a schema driven API? Open an issue,\nwe're confident we can convince you otherwise \ud83d\ude09"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"This article was originally written by\n",(0,o.kt)("a",{parentName:"em",href:"https://twitter.com/calebmer"},"Caleb Meredith"),".")),(0,o.kt)("div",{className:"footnotes"},(0,o.kt)("hr",{parentName:"div"}),(0,o.kt)("ol",{parentName:"div"},(0,o.kt)("li",{parentName:"ol",id:"fn-1"},'"Well implemented" because it\'s easy to write code that performs really\nbadly in the database (just as it is in the application layer) if you use the\nwrong approach. The procedural patterns you may have learned in your\nprogramming language of choice are likely not the patterns that you should\nemploy in the database - databases (and SQL) use a more declarative approach to\nprogramming, when you use procedural patterns you can introduce huge\nperformance issues. For example: looping in the database is expensive, instead\nyou should use single statements to process all your data at once in a way that\ncan be highly optimized. Function calls are also expensive in PostgreSQL,\ninstead of calling a function as part of every row (especially when there could\nbe hundreds of millions of rows!) you should try and call a function once for\nthe entire set. We have some documentation on this in ',(0,o.kt)("a",{parentName:"li",href:"./functions#understanding-function-performance"},"Understanding function\nperformance")," and ",(0,o.kt)("a",{parentName:"li",href:"./required-knowledge#writing-performant-rls-policies"},"Writing\nperformant RLS policies"),".",(0,o.kt)("a",{parentName:"li",href:"#fnref-1",className:"footnote-backref"},"\u21a9")))))}h.isMDXComponent=!0}}]);