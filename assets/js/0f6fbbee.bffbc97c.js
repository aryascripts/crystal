"use strict";(self.webpackChunk_localrepo_postgraphile_website=self.webpackChunk_localrepo_postgraphile_website||[]).push([[6709],{30876:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>g});var a=n(2784);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),m=u(n),c=r,g=m["".concat(s,".").concat(c)]||m[c]||d[c]||i;return n?a.createElement(g,l(l({ref:t},p),{},{components:n})):a.createElement(g,l({ref:t},p))}));function g(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[m]="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},91660:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>u});var a=n(7896),r=(n(2784),n(30876));const i={layout:"page",path:"/postgraphile/crud-mutations/",title:"CRUD Mutations"},l=void 0,o={unversionedId:"crud-mutations",id:"version-4.x/crud-mutations",title:"CRUD Mutations",description:'CRUD, or "Create, Read, Update, Delete", is a common paradigm in data',source:"@site/versioned_docs/version-4.x/crud-mutations.md",sourceDirName:".",slug:"/crud-mutations",permalink:"/postgraphile/current/crud-mutations",draft:!1,editUrl:"https://github.com/graphile/crystal/tree/main/postgraphile/website/versioned_docs/version-4.x/crud-mutations.md",tags:[],version:"4.x",frontMatter:{layout:"page",path:"/postgraphile/crud-mutations/",title:"CRUD Mutations"},sidebar:"docs",previous:{title:"Filtering",permalink:"/postgraphile/current/filtering"},next:{title:'Globally Unique Object Identification ("nodeId" / "id")',permalink:"/postgraphile/current/node-id"}},s={},u=[{value:"Examples",id:"examples",level:3},{value:"If mutations don&#39;t show up...",id:"if-mutations-dont-show-up",level:3}],p={toc:u},m="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,'CRUD, or "Create, Read, Update, Delete", is a common paradigm in data\nmanipulation APIs; "CRUD Mutations" refer to all but the "R". PostGraphile will\nautomatically add CRUD mutations to the schema for each table; this behaviour\ncan be disabled via the ',(0,r.kt)("inlineCode",{parentName:"p"},"--disable-default-mutations")," CLI setting (or the\n",(0,r.kt)("inlineCode",{parentName:"p"},"disableDefaultMutations: true")," library setting) if you prefer to define all of\nyour mutations yourself (e.g. with ",(0,r.kt)("a",{parentName:"p",href:"./custom-mutations/"},"custom mutations"),")."),(0,r.kt)("p",null,"Using the ",(0,r.kt)("inlineCode",{parentName:"p"},"users")," table from the ",(0,r.kt)("a",{parentName:"p",href:"./tables/"},"parent article"),", depending on the\nPostGraphile settings you use (and the permissions you've granted), you might\nget the following mutations:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"createUser - Creates a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User"),".\n",(0,r.kt)("a",{parentName:"li",href:"./examples/#Mutations__Create"},"See example"),"."),(0,r.kt)("li",{parentName:"ul"},"updateUser - Updates a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using its globally unique id and a patch."),(0,r.kt)("li",{parentName:"ul"},"updateUserById - Updates a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using a unique key and a patch.\n",(0,r.kt)("a",{parentName:"li",href:"./examples/#Mutations__Update"},"See example"),"."),(0,r.kt)("li",{parentName:"ul"},"updateUserByUsername - Updates a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using a unique key and a patch."),(0,r.kt)("li",{parentName:"ul"},"deleteUser - Deletes a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using its globally unique id."),(0,r.kt)("li",{parentName:"ul"},"deleteUserById - Deletes a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using a unique key.\n",(0,r.kt)("a",{parentName:"li",href:"./examples/#Mutations__Delete"},"See example"),"."),(0,r.kt)("li",{parentName:"ul"},"deleteUserByUsername - Deletes a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using a unique key.")),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"The ",(0,r.kt)("inlineCode",{parentName:"strong"},"update")," and ",(0,r.kt)("inlineCode",{parentName:"strong"},"delete")," mutations are created only if the table contains a\n",(0,r.kt)("inlineCode",{parentName:"strong"},"primary key")," column.")),(0,r.kt)("p",null,'You also get the following query fields ("Read"):'),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"user - Returns a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using its globally unique ",(0,r.kt)("inlineCode",{parentName:"li"},"ID"),"."),(0,r.kt)("li",{parentName:"ul"},"userById - Reads a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using its globally unique ",(0,r.kt)("inlineCode",{parentName:"li"},"ID"),"."),(0,r.kt)("li",{parentName:"ul"},"userByUsername - Reads a single ",(0,r.kt)("inlineCode",{parentName:"li"},"User")," using its unique ",(0,r.kt)("inlineCode",{parentName:"li"},"username"),"."),(0,r.kt)("li",{parentName:"ul"},"allUsers - Returns a ",(0,r.kt)("a",{parentName:"li",href:"./connections/"},"connection")," enabling pagination through\na set of (visible) ",(0,r.kt)("inlineCode",{parentName:"li"},"User"),".")),(0,r.kt)("h3",{id:"examples"},"Examples"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},'# Create a User and get back details of the record we created\nmutation {\n  createUser(\n    input: { user: { id: 1, name: "Bilbo Baggins", username: "bilbo" } }\n  ) {\n    user {\n      id\n      name\n      username\n      createdAt\n    }\n  }\n}\n\n# Update Bilbo using the user.id primary key\nmutation {\n  updateUserById(\n    input: { id: 1, userPatch: { about: "An adventurous hobbit" } }\n  ) {\n    user {\n      id\n      name\n      username\n      about\n      createdAt\n    }\n  }\n}\n\n# Delete Bilbo using the unique user.username column and return the mutation ID\nmutation {\n  deleteUserByUsername(input: { username: "bilbo" }) {\n    deletedUserId\n  }\n}\n')),(0,r.kt)("h3",{id:"if-mutations-dont-show-up"},"If mutations don't show up..."),(0,r.kt)("p",null,"First of all, check for errors being output from your PostGraphile server. If\nthere are no errors, here's some reasons that mutations might not show up in the\ngenerated schema:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"--disable-default-mutations")," (or ",(0,r.kt)("inlineCode",{parentName:"li"},"-M"),") specified (or library equivalent)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"@omit create,update,delete")," smart comments on the tables"),(0,r.kt)("li",{parentName:"ul"},"Insufficient permissions on the tables and ",(0,r.kt)("inlineCode",{parentName:"li"},"--no-ignore-rbac")," specified"),(0,r.kt)("li",{parentName:"ul"},"Tables not in an exposed schema"),(0,r.kt)("li",{parentName:"ul"},"Views instead of tables"),(0,r.kt)("li",{parentName:"ul"},"Missing primary keys (though 'create' mutations will still be added in this\ncase)"),(0,r.kt)("li",{parentName:"ul"},"If you only see mutations using primary key: You might be using the\n",(0,r.kt)("inlineCode",{parentName:"li"},"PrimaryKeyMutationsOnlyPlugin"))),(0,r.kt)("p",null,"Don't forget to check any associated ",(0,r.kt)("inlineCode",{parentName:"p"},".postgraphilerc")," for these settings too!"),(0,r.kt)("p",null,"If you're new to GraphQL, perhaps you're looking in the wrong place? In the\nGraphiQL interface, open the docs on the right and go to the root. Select the\n",(0,r.kt)("inlineCode",{parentName:"p"},"Mutation")," type to see the available mutations. If you try to execute a mutation\n(e.g. using autocomplete) you must use the ",(0,r.kt)("inlineCode",{parentName:"p"},"mutation")," operation type when\ncomposing the request:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-graphql"},"mutation {\n  createThing...\n}\n")),(0,r.kt)("p",null,"otherwise GraphiQL will interpret the request as a query."))}d.isMDXComponent=!0}}]);